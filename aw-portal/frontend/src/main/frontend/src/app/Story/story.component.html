<div class="story-wrapper">
  <div class="btn-group-vertical btn-group-xs col-xs-1" role="group" aria-label="move">
    <button type="button" class="btn btn-default" (click)="moveUp()"
      [disabled]="story.order == 0">
      <span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span>
    </button>
    <button type="button" class="btn btn-default" (click)="moveDown()"
      [disabled]="story.order == swimlane.stories.length-1">
      <span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span>
    </button>
  </div>
  <!-- Story button, with modal attachment -->
  <button class="btn btn-info" (click)="storyModal.show()">
      <span class="badge">{{story.points}}</span> <span class="wordwrap">{{story.title}}</span>
  </button>
</div>
	
<!-- Modal -->

<app-modal #storyModal>
  <div class="app-modal-header">
    <button type="button" class="close" (click)="storyModal.hide()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
    <!-- <div data-ng-hide="editing"> -->
      <h4 class="modal-title" id="myModalLabel"><span class="badge">{{story.points}}</span> {{story.title}}</h4>
    <!-- </div>
    <div data-ng-if="editing">
      <input type="number" data-ng-model="story.points" min=1 max=10 required />
      <input type="text" data-ng-model="story.title" required />
    </div> -->
  </div>
  <div class="app-modal-body">
    <span *ngIf="story.description; else noDesc">&emsp;{{story.description}}</span>
    <ng-template #noDesc>
      <span data-ng-hide="story.description">&emsp;No description</span>
    </ng-template>
    <br><br>
    <h5>Tasks</h5>
    <table *ngIf="story.tasks && story.tasks.length; else noTasks" class="table table-hover table-condensed">
      <tr *ngFor="let task of story.tasks">
        <td><aw-task [task]="task" [story]="story"></aw-task></td>
      </tr>
    </table>
    <ng-template #noTasks>
      <div>
        &emsp;No tasks yet
      </div>
    </ng-template>
    <!-- <form>
      &emsp; <input type="text" data-ng-model="newTask.name" required />
      <button class="btn btn-default" data-ng-click="createTask()">Add
        Task</button>
    </form> -->
  </div>
  <div class="app-modal-footer">
    <!-- <div class="btn-group dropup">
      <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Move to... <span class="caret"></span>
      </button>
      <ul class="dropdown-menu">
        <li data-ng-repeat="otherSwimLane in otherSwimLanes">
          <a data-ng-click="moveTo(otherSwimLane)" data-dismiss="modal">{{otherSwimLane.name}}</a>
        </li>
      </ul>
    </div> -->
    <!-- Where the check story completion is located at-->
    
    <!-- <button type="button" class="btn btn-default" data-ng-hide="story.dateStoryCompleted" data-ng-click="markAsFinished()">
      <span class="glyphicon glyphicon-check" aria-hidden="true"></span>
    </button> -->
    
    
    <button type="button" class="btn btn-default">
      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
    </button>
    <button type="button" class="btn btn-danger">
      <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
    </button>
  </div>
</app-modal>

<!-- <div class="modal fade" data-ng-attr-id="{{ 'modal' + story.id }}"
  tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"
          data-ng-click="closeModal()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <div data-ng-hide="editing">
          <h4 class="modal-title" id="myModalLabel"><span class="badge">{{story.points}}</span> {{story.title}}</h4>
        </div>
        <div data-ng-if="editing">
          <input type="number" data-ng-model="story.points" min=1 max=10 required />
          <input type="text" data-ng-model="story.title" required />
        </div>
      </div>
      <div class="modal-body">
        <h5>Description</h5>
        <div data-ng-if="editing">
          <textarea data-ng-model="story.description"></textarea>
        </div>
        <div data-ng-hide="editing">
          <span data-ng-if="story.description">&emsp;{{story.description}}</span>
          <span data-ng-hide="story.description">&emsp;No description</span>
          <br><br>
          <h5>Tasks</h5>
          <div data-ng-hide="story.tasks.length">&emsp;No tasks yet
          </div>
          <table class="table table-hover table-condensed">
            <tr data-ng-repeat="task in story.tasks">
              <td><scrum-task task="task" story="story"></scrum-task></td>
            </tr>
          </table>
          <form>
            &emsp; <input type="text" data-ng-model="newTask.name" required />
            <button class="btn btn-default" data-ng-click="createTask()">Add
              Task</button>
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <div data-ng-hide="editing">
          <div class="btn-group dropup">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Move to... <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li data-ng-repeat="otherSwimLane in otherSwimLanes">
                <a data-ng-click="moveTo(otherSwimLane)" data-dismiss="modal">{{otherSwimLane.name}}</a>
              </li>
            </ul>
          </div>
          
          <button type="button" class="btn btn-default" data-ng-hide="story.dateStoryCompleted" data-ng-click="markAsFinished()">
            <span class="glyphicon glyphicon-check" aria-hidden="true"></span>
          </button>
          
          
          <button type="button" class="btn btn-default"
            data-ng-click="resetNewTask(); edit()">
            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
          </button>
          <button type="button" class="btn btn-danger" data-toggle="modal" data-ng-attr-data-target="{{ '#deleteStory' + story.id }}">
            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
          </button>
        </div>
        <div data-ng-if="editing">
          <button type="button" class="btn btn-success"
            data-ng-click="update()">
            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
          </button>
          <button type="button" class="btn btn-danger"
            data-ng-click="reset()">
            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div> -->

<!-- Delete Story Modal -->
<!-- <div class="modal fade" data-ng-attr-id="{{ 'deleteStory' + story.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Delete Story</h4>
      </div>
      <div class="modal-body">
        <span>Are you sure that you wish to delete {{story.title}}?</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-ng-click="delete()" data-dismiss="modal">Delete</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div> -->